<div class="row mb-md-0 mb-5">


  <div class="col-md-12 col-sm-6 col-12 d-flex flex-column">
    <form method="GET" action="/search" class="form-inline">
      <input class="form-control mr-sm-2" type="search" placeholder="Search Products" aria-label="Search" name="q"
        id="searchInput">

      <div class="btn-group my-2 my-sm-0 font-poppins">
        <button type="button" class="btn btn-outline-primary font-poppins dropdown-toggle" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          Search
        </button>
        <div class="dropdown-menu">
          <button class="dropdown-item" type="submit">Names</button>
          <button class="dropdown-item" type="button" onclick="searchForLocation()">Locations</button>
        </div>
      </div>

      <!-- <button class="btn btn-outline-primary font-poppins my-2 my-sm-0" type="submit">Search</button> -->
    </form>
  </div>


  <div class="col-md-12 col-sm-6 col-12 d-flex flex-column mt-md-5 mt-sm-0 mt-5">
    <h5 class="font-poppins">Categories</h5>
    <div class="d-flex flex-column font-open-sans">
      <div class="d-flex justify-content-between mt-2">
        <p onclick="filterByCategory(this.id)" id="clothes" class="text-dark m-0" style="cursor: pointer;">Clothes
        </p>
        <span class="badge badge-light text-primary font-poppins"><%= count.clothes %> </span>
      </div>

      <div class="d-flex justify-content-between mt-2">
        <p onclick="filterByCategory(this.id)" id="computer" class="text-dark m-0" style="cursor: pointer;">Computers
        </p>
        <span class="badge badge-light text-primary font-poppins"><%= count.computers %> </span>
      </div>

      <div class="d-flex justify-content-between mt-2">
        <p onclick="filterByCategory(this.id)" id="furniture" class="text-dark m-0" style="cursor: pointer;">Furniture
        </p>
        <span class="badge badge-light text-primary font-poppins"><%= count.furniture %> </span>
      </div>

      <div class="d-flex justify-content-between mt-2">
        <p onclick="filterByCategory(this.id)" id="mobile-device" class="text-dark m-0" style="cursor: pointer;">Mobile
          Phones
        </p>
        <span class="badge badge-light text-primary font-poppins"><%= count.phones %> </span>
      </div>

    </div>
  </div>




  <div class="col-md-12 col-sm-6 col-12 d-flex flex-column mt-md-5 mt-sm-0 mt-5">
    <h5 class="font-poppins">Condition</h5>

    <form method="GET" id="conditionForm" class="d-flex flex-column font-open-sans">

      <div class="custom-control custom-checkbox mt-2">
        <input type="checkbox" class="custom-control-input" id="like-new" name="condition" value="like-new">
        <label class="custom-control-label" for="like-new">Like-new</label>
      </div>

      <div class="custom-control custom-checkbox mt-2">
        <input type="checkbox" class="custom-control-input" id="new-with-tags" name="condition" value="new with tags">
        <label class="custom-control-label" for="new-with-tags">New with tags</label>
      </div>

      <div class="custom-control custom-checkbox mt-2">
        <input type="checkbox" class="custom-control-input" id="gently-used" name="condition" value="gently-used">
        <label class="custom-control-label" for="gently-used">Gently-used</label>
      </div>

      <div class="custom-control custom-checkbox mt-2">
        <input type="checkbox" class="custom-control-input" id="signs-of-use" name="condition" value="signs of use">
        <label class="custom-control-label" for="signs-of-use">Signs of use</label>
      </div>

      <div class="d-flex mt-4 font-poppins">
        <input class="btn btn-primary" type="submit" value="Apply">
        <input class="btn btn-secondary ml-3" type="reset" value="Reset">
      </div>

    </form>

  </div>

</div>

<script>
  const conditionForm = document.getElementById('conditionForm')

  conditionForm.addEventListener('submit', (e) => {
    e.preventDefault()
    const form = e.target
    const formData = new FormData(form)

    const searchParams = new URLSearchParams(location.search)
    searchParams.delete('condition')

    for (let pair of formData.entries()) {
      searchParams.append(pair[0], pair[1])
    }
    location.replace(`/?${searchParams.toString()}`)
  })

  conditionForm.addEventListener('reset', () => {
    location.href = '/'
  })
  function searchForLocation() {
    const query = document.getElementById('searchInput').value
    location.href = `/search?location=${query}`
  }
  function filterByCategory(value) {
    value = value.split('-').join(' ') // because I need "mobile-device" to be "mobile device". I'm passing the value as an (id).
    const searchParams = new URLSearchParams(location.search)
    searchParams.set('category', value)
    location.replace(`/?${searchParams.toString()}`)
  }
</script>